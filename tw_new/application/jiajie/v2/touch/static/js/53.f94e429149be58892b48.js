webpackJsonp([53],{"/LsR":function(t,s){},Axi2:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("P9l9"),n=e("oAV5"),a=e("9qR2"),o={components:{editAddress:e("66f8").a,orderConfirmation:a.a},data:function(){return{lists:[],order_deductible_type:0,isshow:!1,indexs:"",uploadFileUrl:i.a.uploadFileUrl+"/",addslists:[],addnema:"",contact_lal:"",addtel:"",addaddres:"",contact_address_name:"",minDate:this.addMin(),showTime:!1,currentDate:this.addMin(),long:1,message:"",getTimes:"",money:0,mennum:0,addAddress:!1,payShow:!1,addList:!1,orderData:{},store_id:this.$route.query.store_id,service_info:{},unitList:this.$store.state.unitList,notin:[]}},mounted:function(){var t=this;this.$route.query.list&&(this.lists=JSON.parse(this.$route.query.list)),this.lists.length&&(this.lists.forEach(function(s){t.mennum+=s.item_change*s.goodsnumber}),this.getOrder()),this.money=this.mennum,this.init(),this.getAddressList()},watch:{long:function(t){this.money=(this.mennum*t).toFixed(2)},addAddress:function(t){t||this.getAddressList()}},methods:{getOrder:function(){},getUnit:function(t){var s="";return this.unitList.length&&this.unitList.forEach(function(e){e.id==t&&(s=e.unit_name)}),s},setCycle:function(t){t?this.long++:this.long--,this.long<1&&(this.long=1)},formatter:function(t,s){return"year"===t?s+"年":"month"===t?s+"月":"day"===t?s+"日":"hour"===t?s+"时":"minute"===t?s+"分":s},replaceStyle:function(t){return t.replace(/<[^<>]+>/g,"")},isWechat:function(){return-1!=navigator.userAgent.toLowerCase().indexOf("micromessenger")},addMin:function(){return new Date((new Date).valueOf()+18e5)},onClickLeft:function(){this.$router.back(-1)},init:function(){var t=this;this.$fetch("user_info_get",{}).then(function(s){t.cons_jifen=parseFloat(s.user_score),t.user_balance=parseFloat(s.user_balance)}),this.$fetch("service_get",{get_store_info:1},this.store_id).then(function(s){t.service_info=s,0==t.lists.length&&(t.mennum=s.row.service_remuneration,t.money=t.mennum)}).catch(function(t){}),this.$fetch("service_util_list").then(function(s){t.unitList=s}).catch(function(t){})},setTime:function(t){var s=t.getValues();this.getTimes=s[0]+s[1]+s[2]+s[3]+s[4],this.getTimes=n.a.convertDataFormat(this.getTimes),this.getTimes=new Date(this.getTimes.replace(/-/g,"/"))},timeSuccess:function(){this.getTimes?this.currentDate=this.getTimes:this.currentDate=this.addMin(),this.getOrder(),this.showTime=!1},closeTime:function(){this.showTime=!1},getTime:function(t){var s=new Date(t);return s?s.getFullYear()+"年"+this.add0(s.getMonth()+1)+"月"+this.add0(s.getDate())+"日"+this.add0(s.getHours())+"时"+this.add0(s.getMinutes())+"分":""},add0:function(t){return(t=Number(t))<10&&(t="0"+t),t},getAddressList:function(){var t=this;this.$fetch("user_address_list",{row:50,service_id:this.store_id}).then(function(s){if(t.addslists=s.within,t.notin=s.notin,t.addslists.length>0){var e=t.addslists.reverse()[0];t.addnema=e.contact_name,t.addtel=e.telephone_number,t.addaddres=e.contact_house_number,t.contact_lal=e.contact_lal,t.contact_address_name=e.contact_address_name}})},selectAddress:function(t,s){this.addnema=t.contact_name,this.contact_lal=t.contact_lal,this.addtel=t.telephone_number,this.addaddres=t.contact_house_number,this.contact_address_name=t.contact_address_name,this.addList=!1},pay:function(){var t={contact_name:this.addnema,address_name:this.addaddres+this.contact_address_name,order_phone:this.addtel,service_message:this.message,order_lal:this.contact_lal,total:Number(this.money),service_id:this.store_id,contact_appointment_at:this.currentDate,service_length:this.long};if(this.lists.length){var s=[];this.lists.forEach(function(t){s.push({id:t.id,length:t.goodsnumber})}),t.service_item=s}this.orderData=t,this.payShow=!0}}},c={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"orderd"},[i("van-nav-bar",{attrs:{title:"提交订单","left-arrow":""},on:{"click-left":t.onClickLeft}}),t._v(" "),i("div",{staticClass:"body"},[i("div",{staticClass:"adds"},[""==t.addnema?i("div",{staticClass:"addsri",on:{click:function(s){t.addList=!0}}},[t._m(0),t._v(" "),i("div",{staticClass:"addcor"},[t._v("\n\t\t\t\t\t请选择联系地址\n\t\t\t\t")])]):i("div",{staticClass:"addsri",on:{click:function(s){t.addList=!0}}},[i("div",{staticClass:"lrm"},[i("div",[t._v("联系人："+t._s(t.addnema))]),t._v(" "),i("div",[t._v(t._s(t.addtel))])]),t._v(" "),i("div",{staticClass:"addcor"},[t._v("\n\t\t\t\t\t联系地址："+t._s(t.contact_address_name)+t._s(t.addaddres)+"\n\t\t\t\t")])]),t._v(" "),i("div",{staticClass:"right"})]),t._v(" "),Object.keys(t.service_info).length?i("div",{staticClass:"com_box"},[i("ul",{staticClass:"ul_coms"},[i("li",{staticClass:"list_coms"},[i("div",{staticClass:"list_coms_dimg"},[t._m(1),t._v(" "),i("span",[t._v(t._s(t.service_info.store_info.store_name))])]),t._v(" "),i("div",{staticClass:"com_com"},[i("div",[t.service_info.store_info.store_pic&&t.service_info.store_info.store_pic[0]&&t.service_info.store_info.store_pic[0].length?i("img",{attrs:{src:t.uploadFileUrl+t.service_info.store_info.store_pic[0]}}):i("img",{attrs:{src:e("y8yI")}})]),t._v(" "),i("div",{staticClass:"com_com_x"},[i("div",{staticClass:"com_com_x_score"},[i("div",[i("span",{staticStyle:{"font-size":".16rem"}},[t._v(t._s(t.service_info.row.service_name))])])]),t._v(" "),i("div",{staticClass:"com_com_x_score_colco"},t._l(t.lists,function(s,e){return i("div",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(s.item_name)+"   ￥"+t._s(s.item_change)+"元   数量："+t._s(s.goodsnumber)+"\n\t\t\t\t\t\t\t\t")])})),t._v(" "),i("div",{staticClass:"com_com_x_score2"},[i("div",[t._v("￥"+t._s(t.service_info.row.service_remuneration)),i("span",[t._v(t._s(t.getUnit(t.service_info.row.service_value_unit_id)))])])])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isshow,expression:"isshow"}],staticClass:"po_box"},[i("div",{staticClass:"po_box_div"},[i("div",{staticClass:"po_box_div_tit"},[t._v("提示")]),t._v(" "),t.indexs?i("div",{staticClass:"po_box_div_com"},[t._v("\n\t\t\t\t\t\t\t\t确定要删除此订单？\n\t\t\t\t\t\t\t")]):i("div",{staticClass:"po_box_div_com"},[t._v("\n\t\t\t\t\t\t\t\t确定要取消此订单？\n\t\t\t\t\t\t\t")]),t._v(" "),i("div",{staticClass:"po_box_but"},[i("div",{on:{click:function(s){s.stopPropagation(),t.xbut()}}},[t._v("取消")]),t._v(" "),i("div",{on:{click:function(s){if(!("button"in s)&&t._k(s.keyCode,"syop",void 0,s.key,void 0))return null;t.spilits(t.its,t.index)}}},[t._v("确认")])])])])])])]):t._e(),t._v(" "),i("div",{staticClass:"time",on:{click:function(s){t.showTime=!0}}},[i("div",[t._v("上门时间")]),t._v(" "),i("div",[t._v(t._s(t.getTime(t.currentDate)))])]),t._v(" "),t.service_info.row&&1!=t.service_info.row.service_value_unit_id?i("div",{staticClass:"long"},[i("div",[t._v("收费单位")]),t._v(" "),i("div",{staticClass:"btn"},[i("div",{staticClass:"left",on:{click:function(s){t.setCycle(0)}}},[t._v("-")]),t._v(" "),i("div",{staticClass:"middle"},[t._v(t._s(t.long)),t.service_info.row?i("span",[t._v(t._s(t.getUnit(t.service_info.row.service_value_unit_id).replace("元/","")))]):t._e()]),t._v(" "),i("div",{staticClass:"right",on:{click:function(s){t.setCycle(1)}}},[t._v("+")])])]):t._e(),t._v(" "),i("div",{staticClass:"notime"},[i("div",[t._v("下单留言：")]),t._v(" "),i("div",{staticClass:"input"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{name:"",rows:"2",cols:"",placeholder:"如有特殊要求，请在此填写附信"},domProps:{value:t.message},on:{input:function(s){s.target.composing||(t.message=s.target.value)}}})])]),t._v(" "),i("div",{staticClass:"money"},[i("div",[t._v("小计：￥")]),t._v(" "),i("div",{staticClass:"num"},[t._v("\n\t\t\t\t"+t._s(t.mennum)+"\n\t\t\t")])]),t._v(" "),i("div",{staticClass:"bot_box"},[i("div",{staticClass:"bot_div"},[i("div",{staticClass:"bot_div_men"},[1!=t.long?i("div",{staticClass:"but_num"},[t._v("\n\t\t\t\t\t\t总计："),i("span",{staticClass:"but_span"},[t._v("￥"),i("span",{staticClass:"but_span_men"},[t._v(t._s(t.money))])])]):i("div",{staticClass:"but_num"},[t._v("\n\t\t\t\t\t\t总计："),i("span",{staticClass:"but_span"},[t._v("￥"),i("span",{staticClass:"but_span_men"},[t._v(t._s(t.mennum))])])])]),t._v(" "),i("div",{staticClass:"bot_div_zf",on:{click:t.pay}},[t._v("\n\t\t\t\t\t去支付\n\t\t\t\t")])])]),t._v(" "),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showTime,callback:function(s){t.showTime=s},expression:"showTime"}},[i("van-datetime-picker",{attrs:{"confirm-button-text":"完成","cancel-button-text":"返回",type:"year-month-day-hour-minute","min-date":t.minDate,formatter:t.formatter},on:{change:function(s){t.setTime(s)},cancel:t.closeTime,confirm:t.timeSuccess},model:{value:t.currentDate,callback:function(s){t.currentDate=s},expression:"currentDate"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.addList,expression:"addList"}],staticClass:"addsa"},[i("div",{staticClass:"addsa_div"},[i("ul",[t._l(t.addslists,function(s,e){return i("li",{on:{click:function(i){t.selectAddress(s,e)}}},[i("div",{staticClass:"addsri"},[i("div",{staticClass:"lrm"},[i("div",[t._v("\n\t\t\t\t\t\t\t\t\t联系人："+t._s(s.contact_name)+"\n\t\t\t\t\t\t\t\t")]),t._v(" "),i("div",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(s.telephone_number)+"\n\t\t\t\t\t\t\t\t")])]),t._v(" "),i("div",{staticClass:"addcor"},[t._v("\n\t\t\t\t\t\t\t\t联系地址："+t._s(s.contact_address_name)+"\n\t\t\t\t\t\t\t")])])])}),t._v(" "),i("li",[i("div",{staticStyle:{"text-align":"center","font-size":".16rem"},on:{click:function(s){t.addAddress=!0,t.addList=!1}}},[t._v("\n\t\t\t\t\t\t\t添加新地址\n\t\t\t\t\t\t")])]),t._v(" "),t.notin.length>0?i("div",[t._v("以下地址超出服务范围：")]):t._e(),t._v(" "),t._l(t.notin,function(s,e){return i("li",{staticStyle:{color:"#969896"}},[i("div",{staticClass:"addsri"},[i("div",{staticClass:"lrm"},[i("div",[t._v("\n\t\t\t\t\t\t\t\t\t联系人："+t._s(s.contact_name)+"\n\t\t\t\t\t\t\t\t")]),t._v(" "),i("div",[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(s.telephone_number)+"\n\t\t\t\t\t\t\t\t")])]),t._v(" "),i("div",{staticClass:"addcor"},[t._v("\n\t\t\t\t\t\t\t\t联系地址："+t._s(s.contact_address_name)+"\n\t\t\t\t\t\t\t")])])])})],2)])])],1),t._v(" "),i("edit-address",{attrs:{addData:{}},model:{value:t.addAddress,callback:function(s){t.addAddress=s},expression:"addAddress"}}),t._v(" "),i("orderConfirmation",{attrs:{orderData:t.orderData,orderType:3},model:{value:t.payShow,callback:function(s){t.payShow=s},expression:"payShow"}})],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"lrm"},[s("div",[this._v("\n\t\t\t\t\t\t添加地址\n\t\t\t\t\t")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("span",[s("img",{attrs:{src:e("5NiS")}})])}]};var d=e("VU/8")(o,c,!1,function(t){e("/LsR")},"data-v-6d4da00f",null);s.default=d.exports}});