webpackJsonp([10],{DMUp:function(t,e){},sUju:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=[{key:1,title:"星期一"},{key:2,title:"星期二"},{key:3,title:"星期三"},{key:4,title:"星期四"},{key:5,title:"星期五"},{key:6,title:"星期六"},{key:7,title:"星期日"}],o={name:"chargeStrategy",data:function(){var t=this;return{customColumns:[{title:"日期",key:"choose_date",render:function(t,e){var a="";return 1==e.row.change_type?(i.forEach(function(t){t.key==e.row.choose_date&&(a=t.title)}),t("span","每逢"+a)):t("span",e.row.choose_date)}},{title:"改动时间",render:function(t,e){return t("span",e.row.begin_at+"-"+e.row.end_at)}},{title:"价格变动",key:"price_change",render:function(t,e){return t("span",("INCR"==e.row.diff_type?"+":"-")+e.row.price_change)}},{title:"操作",key:"_action",render:function(e,a){return e("div",[e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleRemoveItem(a.row.id,a.index,a.row.change_type)}}},"删除")])}}],serviceId:parseInt(this.$route.query.id||0),chargeType:[{type:"INCR",title:"提升"},{type:"REDU",title:"下降"}],daysItems:i,elasticForm:{change_type:1,choose_date:1,time_interval:["00:00","23:00"],price_change:0,diff_type:"INCR"},customForm:{change_type:2,choose_date:"",time_interval:["00:00","23:00"],price_change:0,diff_type:"INCR"},customData:[],elasticData:[]}},mounted:function(){var t=this;[1,2].forEach(function(e){t.getRulesList(1,e)});var e=new Date,a=e.getFullYear(),i=e.getMonth()+1,o=e.getDate();this.customForm.choose_date=a+"-"+i+"-"+o},methods:{addRuleItem:function(t){var e=this,a=this[t]||{};a.time_interval&&(a.begin_at=a.time_interval[0],a.end_at=a.time_interval[1],delete a.time_interval),console.log(a),this.$http("service.pricerule.add-"+this.serviceId,a).then(function(i){var o=t.replace(/Form$/,"")+"Data";e[o]&&(a.id=i.data.id,e[o].push(a))})},handleCustomFormChange:function(t){this.customForm.time_interval=t},handleElasticFormChange:function(t){this.elasticForm.time_interval=t},handleCustomDateChange:function(t){this.customForm.choose_date=t},getRulesList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.$http("service.pricerule.list",{condition:{service_id:this.service_id,change_type:a},page:e,rows:30}).then(function(e){1==a?t.elasticData=e.data:t.customData=e.data})},handleRemoveItem:function(t,e,a){var i=this;this.$http("service.pricerule.delete-"+t).then(function(t){1==a?i.elasticData.splice(e,1):i.customData.splice(e,1)})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{attrs:{title:"收费策略设置"}},[a("div",{attrs:{slot:"extra"},slot:"extra"},[a("Button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.$router.push({name:"servicesIndex"})}}},[t._v("返回服务列表")])],1),t._v(" "),a("Tabs",{attrs:{value:"periodicity",id:"chargeStrategyTabs"}},[a("TabPane",{attrs:{label:"周期性弹性价格",name:"periodicity"}},[a("Form",{attrs:{"label-width":80},model:{value:t.elasticForm,callback:function(e){t.elasticForm=e},expression:"elasticForm"}},[a("FormItem",{staticStyle:{float:"left",width:"300px"},attrs:{label:"选择周期：",prop:"choose_date"}},[a("Select",{staticStyle:{width:"160px"},model:{value:t.elasticForm.choose_date,callback:function(e){t.$set(t.elasticForm,"choose_date",e)},expression:"elasticForm.choose_date"}},t._l(t.daysItems,function(e,i){return a("Option",{key:i,attrs:{value:e.key}},[t._v(t._s(e.title))])}))],1),t._v(" "),a("FormItem",{staticStyle:{float:"left",width:"250px"},attrs:{label:"开始时间：",prop:"user"}},[a("TimePicker",{attrs:{value:t.customForm.time_interval,format:"HH:mm",type:"timerange",placement:"bottom-end",placeholder:"点击选择"},on:{"on-change":t.handleElasticFormChange}})],1),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("FormItem",{staticStyle:{float:"left",width:"250px"},attrs:{label:"改动：",prop:"user"}},[a("Select",{staticStyle:{width:"160px"},model:{value:t.customForm.diff_type,callback:function(e){t.$set(t.customForm,"diff_type",e)},expression:"customForm.diff_type"}},t._l(t.chargeType,function(e,i){return a("Option",{key:i,attrs:{value:e.type}},[t._v(t._s(e.title))])}))],1),t._v(" "),a("FormItem",{staticStyle:{float:"left",width:"250px"},attrs:{label:"价格：",prop:"price_change"}},[a("Input",{attrs:{placeholder:"输入变动价格多少"},model:{value:t.elasticForm.price_change,callback:function(e){t.$set(t.elasticForm,"price_change",e)},expression:"elasticForm.price_change"}})],1),t._v(" "),a("Button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",shape:"circle",icon:"md-add"},on:{click:function(e){t.addRuleItem("elasticForm")}}})],1),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("Table",{attrs:{columns:t.customColumns,data:t.elasticData}})],1),t._v(" "),a("TabPane",{attrs:{label:"自定义弹性价格",name:"custom"}},[a("Form",{attrs:{"label-width":80},model:{value:t.customForm,callback:function(e){t.customForm=e},expression:"customForm"}},[a("FormItem",{staticStyle:{float:"left",width:"300px"},attrs:{label:"选择日期：",prop:"choose_date"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{value:t.customForm.choose_date,type:"date",placeholder:"选择日期"},on:{"on-change":t.handleCustomDateChange}})],1),t._v(" "),a("FormItem",{staticStyle:{float:"left",width:"250px"},attrs:{label:"开始时间：",prop:"time_interval"}},[a("TimePicker",{attrs:{value:t.customForm.time_interval,format:"HH:mm",type:"timerange",placement:"bottom-end",placeholder:"点击选择"},on:{"on-change":t.handleCustomFormChange}})],1),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("FormItem",{staticStyle:{float:"left",width:"250px"},attrs:{label:"改动：",prop:"diff_type"}},[a("Select",{staticStyle:{width:"160px"},model:{value:t.customForm.diff_type,callback:function(e){t.$set(t.customForm,"diff_type",e)},expression:"customForm.diff_type"}},t._l(t.chargeType,function(e,i){return a("Option",{key:i,attrs:{value:e.type}},[t._v(t._s(e.title))])}))],1),t._v(" "),a("FormItem",{staticStyle:{float:"left",width:"250px"},attrs:{label:"价格：",prop:"price_change"}},[a("Input",{attrs:{placeholder:"输入变动价格多少"},model:{value:t.customForm.price_change,callback:function(e){t.$set(t.customForm,"price_change",e)},expression:"customForm.price_change"}})],1),t._v(" "),a("Button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",shape:"circle",icon:"md-add"},on:{click:function(e){t.addRuleItem("customForm")}}})],1),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("Table",{attrs:{columns:t.customColumns,data:t.customData}})],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,r,!1,function(t){a("DMUp")},"data-v-6b8c9914",null);e.default=c.exports}});
//# sourceMappingURL=10.89121bc42a1e7620e3eb.js.map