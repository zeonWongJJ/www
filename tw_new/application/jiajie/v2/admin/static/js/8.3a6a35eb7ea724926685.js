webpackJsonp([8],{Y3O0:function(e,t){},qvI4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=window.config.api_prefix,l={name:"broadcast",mounted:function(){this.getList(),this.formInline.uploadList=this.$refs.upload.fileList},data:function(){return{api_prefix:a,imgName:"",visible:!1,defaultList:[],uploadList:[],columns:[{title:"轮播模板主题",key:"slide_name"},{title:"轮播图片路径",key:"broadcast_url",render:function(e,t){return e("img",{domProps:{src:a+"/"+t.row.slide_img_url},style:{width:"50px"}})}},{title:"轮播模板超链接",key:"slide_href"}],data:[],formInline:{slide_img_url:"",slide_name:"",slide_href:""},ruleInline:{slide_img_url:[{required:!0,message:"The name cannot be empty",trigger:"blur"}],slide_name:[{required:!0,message:"The name cannot be empty",trigger:"blur"}],slide_href:[{required:!0,message:"The name cannot be empty",trigger:"blur"}]},addModalShow:!1}},methods:{getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$http("slide.list",{rows:30,page:t}).then(function(t){e.data=t.data})},addtemplate:function(){var e=this;this.$refs.formInline.validate(function(t){t&&(e.formInline.slide_show_end_time=0,e.$http("slide.add",e.formInline).then(function(t){e.addModalShow=!1,e.data.push(e.formInline)}))})},handleView:function(e){this.imgName=e,this.visible=!0},handleRemove:function(e){var t=this,i=e.url.replace(a,"");this.$http("file.remove",{files:[i]}).then(function(i){if(0==i.error){var a=t.$refs.upload.fileList;t.formInline.uploadList.splice(a.indexOf(e),1)}})},handleSuccess:function(e){0==e.error&&(this.formInline.slide_img_url=e.data.path,this.uploadList=[],this.uploadList.push({name:e.data.source_name,url:a+"/"+e.data.path,status:"finished"}))},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},handleBeforeUpload:function(){var e=this.formInline.uploadList.length<5;return e||this.$Notice.warning({title:"Up to five pictures can be uploaded."}),e}}},n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Card",{attrs:{title:"轮播图片设置"}},[i("Row",{staticStyle:{"margin-bottom":"10px"}},[i("Button",{attrs:{size:"small",type:"success",icon:"md-add"},on:{click:function(t){e.addModalShow=!0}}},[e._v("新增轮播模板")])],1),e._v(" "),i("Table",{attrs:{columns:e.columns,data:e.data}}),e._v(" "),i("Modal",{attrs:{title:"轮播模板"},on:{"on-ok":e.addtemplate},model:{value:e.addModalShow,callback:function(t){e.addModalShow=t},expression:"addModalShow"}},[i("Form",{ref:"formInline",attrs:{model:e.formInline,rules:e.ruleInline,"label-width":85}},[i("FormItem",{attrs:{prop:"slide_name",label:"轮播模板主题"}},[i("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入轮播模板主题"},model:{value:e.formInline.slide_name,callback:function(t){e.$set(e.formInline,"slide_name",t)},expression:"formInline.slide_name"}})],1),e._v(" "),i("FormItem",{attrs:{prop:"slide_href",label:"轮播模板跳转链接"}},[i("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入轮播模板跳转链接"},model:{value:e.formInline.slide_href,callback:function(t){e.$set(e.formInline,"slide_href",t)},expression:"formInline.slide_href"}})],1),e._v(" "),i("FormItem",{attrs:{prop:"slide_img_url",label:"轮播图片"}},[e._l(e.uploadList,function(t){return i("div",{staticClass:"demo-upload-list"},["finished"===t.status?[i("img",{attrs:{src:t.url}}),e._v(" "),i("div",{staticClass:"demo-upload-list-cover"},[i("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(i){e.handleView(t.url)}}}),e._v(" "),i("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(i){e.handleRemove(t)}}})],1)]:e._e()],2)}),e._v(" "),i("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":e.defaultList,"on-success":e.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,multiple:"",name:"image",type:"drag",action:e.api_prefix+"/upload.image"}},[i("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[i("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)])],2)],1)],1),e._v(" "),i("Modal",{attrs:{title:"View Image"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:e.imgName}}):e._e()])],1)},staticRenderFns:[]};var s=i("VU/8")(l,n,!1,function(e){i("Y3O0")},"data-v-be4e7112",null);t.default=s.exports}});
//# sourceMappingURL=8.3a6a35eb7ea724926685.js.map