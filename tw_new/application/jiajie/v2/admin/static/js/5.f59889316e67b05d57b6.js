webpackJsonp([5],{"+Z2V":function(e,t){},B6CB:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("fZjL"),s=i.n(a),o=i("mvHQ"),n=i.n(o),r=i("GXH0"),c=i.n(r),l=(i("DmJO"),{name:"ServiceExpand",props:{row:Object}}),d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"8"}},[i("span",{staticClass:"expand-key"},[e._v("服务的评论数: ")]),e._v(" "),i("span",{staticClass:"expand-value"},[e._v(e._s(e.row.service_comment_count))])]),e._v(" "),i("Col",{attrs:{span:"8"}},[i("span",{staticClass:"expand-key"},[e._v("服务好评数: ")]),e._v(" "),i("span",{staticClass:"expand-value"},[e._v(e._s(e.row.service_hp_count))])]),e._v(" "),i("Col",{attrs:{span:"8"}},[i("span",{staticClass:"expand-key"},[e._v("服务总得分: ")]),e._v(" "),i("span",{staticClass:"expand-value"},[e._v(e._s(e.row.service_score_count))])])],1),e._v(" "),i("Row",[i("Col",{attrs:{span:"8"}},[i("span",{staticClass:"expand-key"},[e._v("销量: ")]),e._v(" "),i("span",{staticClass:"expand-value"},[e._v(e._s(e.row.service_sold))])])],1)],1)},staticRenderFns:[]};var h=i("VU/8")(l,d,!1,function(e){i("FGs9")},"data-v-e65b0300",null).exports,m=i("/IwO"),v=i.n(m),u={props:{value:{type:Boolean,default:!1},businessTime:{type:Array,default:function(){return["08:00","20:30"]}}},data:function(){return{defaultLong:1,cycleLong:1,show:!1,arr:[],week:[{type:"1",name:"周一"},{type:"2",name:"周二"},{type:"3",name:"周三"},{type:"4",name:"周四"},{type:"5",name:"周五"},{type:"6",name:"周六"},{type:"0",name:"周日"}],defaultWeek:"1",periodicData:{},checked:0,startDay:"",allStartTime:[],allOrder:{},startTime:"",selectStart:!1}},watch:{value:function(e){this.show=e},defaultLong:function(e){this.setArr()},startTime:function(e){e&&this.getOrder()},cycleLong:function(e){this.getOrder()}},mounted:function(){this.setArr()},methods:{getGray:function(e){var t=!1;if(this.periodicData[this.defaultWeek]){var i=this.periodicData[this.defaultWeek].order,a=2*this.defaultLong-1;i.forEach(function(i){var s=(i-480)/30;(e>s&&e<=s+a||e<s&&e>=s-a)&&(t=!0)})}return t},setArr:function(){this.arr=[];var e=60*Number(this.businessTime[0].split(":")[0])+Number(this.businessTime[0].split(":")[1]),t=60*Number(this.businessTime[1].split(":")[0])+Number(this.businessTime[1].split(":")[1]),i=60*this.defaultLong,a=(t-e)/30;//!(end == parseInt(end));
(t-e)%30&&(a=parseInt(a)+1);for(var s=e,o=1;o<=a;o++){var n=s+i;if(n<=t){var r=[];r.push(s,n),this.arr.push(r),s+=30}}},getH:function(e){var t=e%60,i=parseInt(e/60),a=0;return t&&(a=e-60*i),this.add0(i)+":"+this.add0(a)},getDay:function(e){var t=new Date(e);if(t){var i="";switch(t.getDay()){case 0:i="周日";break;case 1:i="周一";break;case 2:i="周二";break;case 3:i="周三";break;case 4:i="周四";break;case 5:i="周五";break;case 6:i="周六"}return i}return console.log("时间格式有误："+e),""},formatTime:function(e,t){var i=new Date(e);if(i){var a=i.getFullYear(),s=this.add0(i.getMonth()+1),o=this.add0(i.getDate()),n=this.add0(i.getHours()),r=this.add0(i.getMinutes());return o?a+"-"+s+"-"+o:a+"-"+s+"-"+o+"-"+n+":"+r}return console.log("时间格式有误："+e),""},add0:function(e){return(e=Number(e))<10&&(e="0"+e),e},setLong:function(e){var t=this;this.periodicData[this.defaultWeek]?this.$dialog.confirm({message:"已选择"+this.defaultLong+"服务时长，是否重新选择"}).then(function(){t.checked=1,delete t.periodicData[t.defaultWeek]}).catch(function(){}):(e?this.defaultLong+=.5:this.defaultLong-=.5,this.defaultLong<1&&(this.defaultLong=1),this.defaultLong>6&&(this.defaultLong=6))},setCycle:function(e){e?this.cycleLong++:this.cycleLong--,this.cycleLong<1&&(this.cycleLong=1)},close:function(){this.$emit("input",!1)},selectWeek:function(e){this.defaultWeek=e,this.periodicData[e]&&(this.defaultLong=this.periodicData[e].long)},selectTime:function(e,t){var i=this;if(!this.getGray(t))if(this.startTime)this.$dialog.confirm({message:"已选择首次服务时间，是否要重新选择"}).then(function(){i.startTime=""}).catch(function(){});else{if(this.checked++,this.periodicData[this.defaultWeek]&&this.defaultLong==this.periodicData[this.defaultWeek].long){var a=!1,s=this.periodicData[this.defaultWeek].order;if(s.forEach(function(t){t==e&&(a=!0)}),a){var o=s.indexOf(e);s.splice(o,1),0==s.length&&delete this.periodicData[this.defaultWeek]}else s.push(e)}else this.periodicData[this.defaultWeek]={},this.periodicData[this.defaultWeek].long=this.defaultLong,this.periodicData[this.defaultWeek].order=[],this.periodicData[this.defaultWeek].order.push(e);this.getStartTime()}},getStartTime:function(){for(var e=new Date,t=e.getFullYear(),i=this.add0(e.getMonth()+1),a=this.add0(e.getDate()),o=new Date(t+"/"+i+"/"+a),n=new Date(o.getTime()+1728e5),r=n.getDay(),c=s()(this.periodicData),l=0,d=0,h=0;h<6;h++){var m=r+h>6?r+h-7:r+h;if(c.indexOf(m.toString())>=0){l=h,d=m;break}}var v=new Date(n.getTime()+24*l*3600*1e3),u=[];for(h=0;h<7;h++){var g=d+h>6?d+h-7:d+h;if(this.periodicData[g.toString()]){var _=new Date(v.getTime()+24*h*3600*1e3);u.push(_)}}this.allStartTime=u},getOrder:function(){var e,t=this;this.startTime&&function(){var i=new Date(t.startTime).getDay(),a=[],o={},n=7*t.cycleLong,r=function(){var s=i+e>6?(i+e)%7:i+e;t.periodicData[s.toString()]&&t.periodicData[s.toString()].order.sort(g).forEach(function(i){var n=new Date(t.startTime.getTime()+24*e*3600*1e3+60*i*1e3);a.push({time:n,long:t.periodicData[s.toString()].long}),o[s.toString()]?o[s.toString()].order?o[s.toString()].order.push(n):(o[s.toString()].order=[],o[s.toString()].order.push(n)):(o[s.toString()]={},o[s.toString()].order=[],o[s.toString()].order.push(n))})};for(e=0;e<n;e++)r();s()(t.periodicData).forEach(function(e){o[e].long=t.periodicData[e].long}),t.allOrder.resOrder=a,t.allOrder.order=o,t.allOrder.cycleLong=t.cycleLong,t.allOrder.startTime=t.startTime}()},finish:function(){if(s()(this.allStartTime).length&&!this.startTime)return this.selectStart=!0,!1;this.$emit("input",!1),this.$emit("finish",this.allOrder)}}};function g(e,t){return e-t}var _={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"periodicReservation"},[i("Modal",{staticClass:"periodicReservation",attrs:{"footer-hide":!0,closable:!1,"mask-closable":!1,scrollable:!0},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("div",{staticClass:"center",staticStyle:{"font-size":"14px"}},[i("div",{staticClass:"setLong"},[i("div",{staticClass:"label"},[e._v("服务时长")]),e._v(" "),i("div",{staticClass:"btn"},[i("div",{staticClass:"left",on:{click:function(t){e.setLong(0)}}},[e._v("-")]),e._v(" "),i("div",{staticClass:"middle"},[e._v(e._s(e.defaultLong)+"小时")]),e._v(" "),i("div",{staticClass:"right",on:{click:function(t){e.setLong(1)}}},[e._v("+")])])]),e._v(" "),i("div",{staticClass:"time"},[i("div",{staticClass:"title"},[e._v("请选择每周服务时间段")]),e._v(" "),i("div",{staticClass:"label"},e._l(e.week,function(t){return i("div",{staticClass:"li",class:{checked:e.defaultWeek==t.type},on:{click:function(i){e.selectWeek(t.type)}}},[e._v(e._s(t.name))])})),e._v(" "),i("div",{staticClass:"arr"},[e._l(e.arr,function(t,a){return i("div",{staticClass:"li",class:[{checked:e.checked&&e.periodicData[e.defaultWeek]&&e.periodicData[e.defaultWeek].order.indexOf(t[0])>=0},{nochecked:e.getGray(a)}],on:{click:function(i){e.selectTime(t[0],a)}}},[e._v(e._s(e.getH(t[0]))+"~"+e._s(e.getH(t[1])))])}),e._v(" "),i("div",{staticClass:"li",staticStyle:{height:"0px",visibility:"hidden"}}),e._v(" "),i("div",{staticClass:"li",staticStyle:{height:"0px",visibility:"hidden"}}),e._v(" "),i("div",{staticClass:"li",staticStyle:{height:"0px",visibility:"hidden"}}),e._v(" "),i("div",{staticClass:"li",staticStyle:{height:"0px",visibility:"hidden"}})],2)]),e._v(" "),i("div",{staticClass:"cycle"},[i("div",{staticClass:"title"},[e._v("服务周期")]),e._v(" "),i("div",{staticClass:"label"},[i("span",{class:{check:4==e.cycleLong},on:{click:function(t){e.cycleLong=5}}},[e._v("1个月")]),e._v(" "),i("span",{class:{check:12==e.cycleLong},on:{click:function(t){e.cycleLong=13}}},[e._v("3个月")]),e._v(" "),i("span",{class:{check:24==e.cycleLong},on:{click:function(t){e.cycleLong=26}}},[e._v("半年")]),e._v(" "),i("span",{class:{check:48==e.cycleLong},on:{click:function(t){e.cycleLong=52}}},[e._v("1年")]),e._v(" "),i("div",{staticClass:"btn"},[i("div",{staticClass:"left",on:{click:function(t){e.setCycle(0)}}},[e._v("-")]),e._v(" "),i("div",{staticClass:"middle"},[e._v(e._s(e.cycleLong)+"星期")]),e._v(" "),i("div",{staticClass:"right",on:{click:function(t){e.setCycle(1)}}},[e._v("+")])])])]),e._v(" "),i("div",{staticClass:"tip"},[e.periodicData[1]?i("div",e._l(e.periodicData[1].order,function(t){return i("div",{staticClass:"li"},[e._v("每周一 "+e._s(e.getH(t))+"~"+e._s(e.getH(t+60*e.periodicData[1].long)))])})):e._e(),e._v(" "),e.periodicData[2]?i("div",e._l(e.periodicData[2].order,function(t){return i("div",{staticClass:"li"},[e._v("每周二 "+e._s(e.getH(t))+"~"+e._s(e.getH(t+60*e.periodicData[2].long)))])})):e._e(),e._v(" "),e.periodicData[3]?i("div",e._l(e.periodicData[3].order,function(t){return i("div",{staticClass:"li"},[e._v("每周三 "+e._s(e.getH(t))+"~"+e._s(e.getH(t+60*e.periodicData[3].long)))])})):e._e(),e._v(" "),e.periodicData[4]?i("div",e._l(e.periodicData[4].order,function(t){return i("div",{staticClass:"li"},[e._v("每周四 "+e._s(e.getH(t))+"~"+e._s(e.getH(t+60*e.periodicData[4].long)))])})):e._e(),e._v(" "),e.periodicData[5]?i("div",e._l(e.periodicData[5].order,function(t){return i("div",{staticClass:"li"},[e._v("每周五 "+e._s(e.getH(t))+"~"+e._s(e.getH(t+60*e.periodicData[5].long)))])})):e._e(),e._v(" "),e.periodicData[6]?i("div",e._l(e.periodicData[6].order,function(t){return i("div",{staticClass:"li"},[e._v("每周六 "+e._s(e.getH(t))+"~"+e._s(e.getH(t+60*e.periodicData[6].long)))])})):e._e(),e._v(" "),e.periodicData[0]?i("div",e._l(e.periodicData[0].order,function(t){return i("div",{staticClass:"li"},[e._v("每周日 "+e._s(e.getH(t))+"~"+e._s(e.getH(t+60*e.periodicData[0].long)))])})):e._e()]),e._v(" "),i("div",{staticClass:"startTime",on:{click:function(t){e.selectStart=!0}}},[e.startTime?i("div",{staticClass:"left"},[e._v("开始时间"+e._s(e.formatTime(e.startTime,1)))]):i("div",{staticClass:"left"},[e._v("请选择开始时间")]),e._v(" "),i("div",{staticClass:"right"})])]),e._v(" "),i("Button",{attrs:{long:"",type:"primary"},on:{click:e.finish}},[e._v("确认选择")])],1),e._v(" "),i("Modal",{staticClass:"selectStart",attrs:{title:"首次服务时间"},model:{value:e.selectStart,callback:function(t){e.selectStart=t},expression:"selectStart"}},[i("div",{staticClass:"ul"},e._l(e.allStartTime,function(t){return i("div",{staticClass:"li",on:{click:function(i){e.selectStart=!1,e.startTime=t}}},[i("div",{staticClass:"left"},[e._v(e._s(e.formatTime(t,1))+"("+e._s(e.getDay(t))+")")]),e._v(" "),i("i",{staticClass:"iconfont",class:[e.startTime==t?"icon-checkoutline02":"icon-check02"]})])}))])],1)},staticRenderFns:[]};var p=i("VU/8")(u,_,!1,function(e){i("+Z2V")},"data-v-753bd054",null).exports,f=new v.a.AMapManager,S={name:"orderGenerate",components:{Treeselect:c.a,ServiceExpand:h,periodicReservation:p},mounted:function(){this.getSubscribe(),this.getCategory(),this.getUnitList()},data:function(){var e=this;return{currentServiceId:0,serviceItemsTable:!1,loading:!1,modal:{showSelectLocation:{address:!1,currentWindow:{position:[0,0],content:"",events:{},visible:!1},markers:[],show:!1,loading:!1,amapManager:f,zoom:12,lng:0,lat:0,loaded:!0,center:[121.59996,31.197646],events:{init:function(e){},moveend:function(){},zoomchange:function(){},click:function(t){e.modal.showSelectLocation.currentWindow.visible=!1,e.orderItem.order_lat=t.lnglat.lat,e.orderItem.order_lng=t.lnglat.lng,new AMap.Geocoder({}).getAddress(t.lnglat.lng+","+t.lnglat.lat,function(i,a){if("complete"===i&&a.regeocode){var s=a.regeocode.formattedAddress;e.modal.showSelectLocation.address=s,e.$nextTick(function(){e.modal.showSelectLocation.currentWindow.position=[t.lnglat.lng,t.lnglat.lat],e.modal.showSelectLocation.currentWindow.content=s,e.modal.showSelectLocation.currentWindow.visible=!0,e.modal.showSelectLocation.center=[t.lnglat.lng,t.lnglat.lat]})}else alert(n()(a))})}},plugin:["ToolBar",{pName:"MapType",defaultType:0,events:{init:function(e){console.log(e)}}}],searchOption:{city:"广州",citylimit:!0}},showSelectService:{show:!1,loading:!1,total:0,current:0,serviceItemTotal:0,serviceItemCurrent:0,serviceItemLists:[],selectedColumns:[{type:"selection",width:60,align:"center"},{title:"服务项目编号",key:"item_sn"},{title:"服务项目名称",key:"item_name"},{title:"服务项目收费",key:"item_change"},{title:"服务项目描述",key:"item_desc"},{title:"服务项目入库时间",key:"item_add_at"}],serviceColumns:[{type:"expand",width:50,render:function(e,t){return e(h,{props:{row:t.row}})}},{title:"服务名称",key:"service_name"},{title:"所属店铺",key:"store_name"},{title:"价格",key:"service_remuneration"},{title:"操作",key:"_action",render:function(t,i){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.handleSelectService(i.row.id)}}},"选择此服务")])}}],serviceData:[]},showSelectTime:{showOnce:!1,showWeek:!1,onceData:{length:1,time:""},weekData:{},type:0}},unitList:[],subscribeId:this.$route.query.id||0,subscribe:{},categories:[],orderItem:{cate_id:0,order_type_id:0,order_actual_amount:0,telephone:"",contact_name:"李先生",order_lat:0,order_lng:0,address_name:"",house_number:"无门牌号"},orderInfo:{},showOrders:[],total:0}},methods:{getSubscribe:function(){var e=this;this.subscribeId&&this.$http("user.subscribe.get-"+this.subscribeId).then(function(t){e.orderItem.telephone=t.data.subscribe_phone,e.subscribe=t.data})},getCategory:function(){var e=this;this.$http("category.list",{"data-set":"tree",field:"cat_name as label, cate_is_show, cate_icon"}).then(function(t){e.categories=t.data})},getUnitList:function(){var e=this;this.$http("service.util.list").then(function(t){e.unitList=t.data})},getUnit:function(e){var t="";return this.unitList.length&&this.unitList.forEach(function(i){i.id==e&&(t=i.unit_name)}),t},setCycle:function(e){e?this.modal.showSelectTime.onceData.length++:this.modal.showSelectTime.onceData.length--,0==this.modal.showSelectTime.onceData.length&&(this.modal.showSelectTime.onceData.length=1)},onSelectService:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||(this.modal.showSelectService.loading=this.modal.showSelectService.show=!0,this.getServiceList())},getServiceList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.orderItem.cate_id=this.$refs.catSelect.getValue(),this.$http("service.list",{page:t,rows:30,condition:{service_level_1:this.orderItem.cate_id}}).then(function(t){e.modal.showSelectService.loading=!1,e.modal.showSelectService.serviceData=t.data})},changeServicePage:function(e){this.model.showSelectService.current=e,this.getServiceList(e)},onSelectLocation:function(){if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])this.modal.showSelectLocation.show=this.modal.showSelectLocation.loading=!0;else if(this.modal.showSelectLocation.address){var e=this.modal.showSelectLocation.center;this.orderItem.address_name=this.modal.showSelectLocation.address,this.orderItem.lal=e[0]+","+e[1]}},onCancelService:function(){this.orderItem.address_name=""},onSearchResult:function(e){var t=this,i=0,a=0;if(e.length>0){e.forEach(function(e){var s=e.lng,o=e.lat;a+=s,i+=o,t.modal.showSelectLocation.markers.push([e.lng,e.lat])});var s={lng:a/e.length,lat:i/e.length};this.modal.showSelectLocation.center=[s.lng,s.lat],this.modal.showSelectLocation.zoom=18}},handleSelectService:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.serviceItemsTable||(this.serviceItemsTable=!0),this.currentServiceId=e,this.$http("service.item.list",{page:i,rows:30,condition:{service_id:e}}).then(function(i){var a=i.data;a.length?t.modal.showSelectService.serviceItemLists=a:t.$http("service.get-"+e).then(function(e){t.$nextTick(function(){var i=e.data;t.modal.showSelectService.serviceItemLists=[{item_name:i.service_name,item_sn:i.id,item_change:i.service_remuneration,item_desc:i.service_info,item_add_at:i.examine_at}],t.modal.showSelectService.serviceItemTotal=1,t.modal.showSelectService.serviceItemCurrent=1,t.modal.showSelectService.show=!1,t.$refs.serviceItems.selectAll(!0)})})})},onSelectServiceItem:function(e){e.length>1&&this.$Notice.warning({title:"超过最大可选择数量",desc:"最多只能选择1个服务项目"})},onChangeServiceItemPage:function(e){this.handleSelectService(this.currentServiceId,e)},postOrder:function(){var e={};if(e.service_id=this.modal.showSelectService.serviceData.id,e.service_message=this.modal.message,this.orderItem.address_name&&this.orderItem.lal)if(e.address_name=this.orderItem.address_name,e.order_lal=this.orderItem.lal,this.orderItem.telephone&&this.orderItem.contact_name){if(e.contact_name=this.orderItem.contact_name,e.order_phone=this.orderItem.telephone,1==this.modal.showSelectTime.type){if(!this.modal.showSelectTime.onceData.time)return void this.$Notice.warning({desc:"请选择开始时间"});e.contact_appointment_at=this.modal.showSelectTime.onceData.time,e.service_length=this.modal.showSelectTime.onceData.length}else 2==this.modal.showSelectTime.type?(e.orders=this.orderInfo.order,e.startTime=this.orderInfo.startTime,e.cycleLong=this.orderInfo.cycleLong):(this.$Notice.warning({desc:"您是不是忘了选择服务时间了？"}),naiveHasReturn());alert(n()(e))}else this.$Notice.warning({desc:"请确定填写了手机号和联系人"});else this.$Notice.warning({desc:"没有选择地址或者地址信息有误"})},generateOnce:function(){this.modal.showSelectTime.showOnce=!0,this.modal.showSelectTime.type=1,this.orderInfo={}},generateWeek:function(){this.modal.showSelectTime.showWeek=!0,this.modal.showSelectTime.type=2},selectWeek:function(e){var t=this;this.showOrders=[],this.orderInfo=e,s()(e).length&&this.$http("order.charge.calc-"+this.modal.showSelectService.serviceData[0].id,e).then(function(e){t.showOrders=e.data.orders,t.total=e.data.total_price})},getDay:function(e){var t=new Date(e);if(t){var i="";switch(t.getDay()){case 0:i="周日";break;case 1:i="周一";break;case 2:i="周二";break;case 3:i="周三";break;case 4:i="周四";break;case 5:i="周五";break;case 6:i="周六"}return i}return console.log("时间格式有误："+e),""},formatTime:function(e,t){var i=new Date(e),a=new Date(i.getTime()+60*t*60*1e3);console.log(i,a);var s=void 0,o=void 0,n=void 0,r=void 0,c=void 0,l=void 0,d=void 0;return i?(s=i.getFullYear(),o=this.add0(i.getMonth()+1),n=this.add0(i.getDate()),r=this.add0(i.getHours()),c=this.add0(i.getMinutes()),a&&(l=this.add0(a.getHours()),d=this.add0(a.getMinutes())),s+"-"+o+"-"+n+"("+this.getDay(e)+")"+r+":"+c+"-"+l+":"+d):(console.log("时间格式有误："+e),"")},add0:function(e){return(e=Number(e))<10&&(e="0"+e),e}}},w={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Card",{attrs:{title:"订单生成"}},[i("Form",{attrs:{model:e.orderItem,"label-width":80}},[i("FormItem",{attrs:{label:"预约分类"}},[i("treeselect",{ref:"catSelect",staticStyle:{width:"300px"},attrs:{value:e.subscribe.cate_id||0,searchable:!1,multiple:!1,options:e.categories,placeholder:"点击选择分类",noChildrenText:"该分类暂无下级"}})],1),e._v(" "),i("FormItem",{attrs:{label:"服务名称"}},[i("Button",{attrs:{type:"primary"},on:{click:function(t){e.onSelectService(!1)}}},[e._v("\n        "+e._s(e.serviceItemsTable?"重新选择服务":"选择服务")+"\n      ")]),e._v(" "),e.serviceItemsTable?i("Table",{ref:"serviceItems",staticStyle:{"margin-top":"10px"},attrs:{columns:e.modal.showSelectService.selectedColumns,data:e.modal.showSelectService.serviceItemLists},on:{"on-select":e.onSelectServiceItem}}):e._e(),e._v(" "),e.serviceItemsTable?i("Page",{attrs:{size:"small","page-size":30,"show-total":"",current:e.modal.showSelectService.serviceItemCurrent,total:e.modal.showSelectService.serviceItemTotal},on:{"on-change":e.onChangeServiceItemPage}}):e._e()],1),e._v(" "),i("FormItem",{attrs:{label:"预约周期"}},[i("Button",{attrs:{type:"primary",disabled:!e.modal.showSelectService.serviceData[0]},on:{click:e.generateOnce}},[e._v("单次预约")]),e._v(" "),e.modal.showSelectService.serviceData[0]&&2==e.modal.showSelectService.serviceData[0].service_value_unit_id?i("Button",{attrs:{type:"primary"},on:{click:e.generateWeek}},[e._v("\n          周期预约")]):e._e()],1),e._v(" "),Object.keys(e.showOrders).length>0&&2==e.modal.showSelectTime.type?i("FormItem",{attrs:{label:"周期时间"}},e._l(e.showOrders,function(t){return i("div",{staticClass:"li"},[i("div",[e._v(e._s(e.formatTime(1e3*t.order_at,t.order_length))+"  ￥"+e._s(t.charge))])])})):e._e(),e._v(" "),i("FormItem",{attrs:{label:"联系人电话"}},[i("Input",{attrs:{clearable:""},model:{value:e.orderItem.telephone,callback:function(t){e.$set(e.orderItem,"telephone",t)},expression:"orderItem.telephone"}})],1),e._v(" "),i("FormItem",{attrs:{label:"联系人姓名"}},[i("Input",{attrs:{clearable:""},model:{value:e.orderItem.contact_name,callback:function(t){e.$set(e.orderItem,"contact_name",t)},expression:"orderItem.contact_name"}})],1),e._v(" "),i("FormItem",{attrs:{label:"上门地址"}},[i("Button",{attrs:{type:"primary"},on:{click:e.onSelectLocation}},[e._v("选择地址")]),e._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[e._v("\n        定位信息："),i("Input",{staticStyle:{width:"350px"},attrs:{disabled:!0},model:{value:e.orderItem.address_name,callback:function(t){e.$set(e.orderItem,"address_name",t)},expression:"orderItem.address_name"}}),e._v("\n        门牌号:"),i("Input",{staticStyle:{width:"350px"},attrs:{clearable:""},model:{value:e.orderItem.house_number,callback:function(t){e.$set(e.orderItem,"house_number",t)},expression:"orderItem.house_number"}})],1)],1),e._v(" "),i("FormItem",{attrs:{label:"订单留言"}},[i("Input",{attrs:{clearable:""},model:{value:e.orderItem.message,callback:function(t){e.$set(e.orderItem,"message",t)},expression:"orderItem.message"}})],1),e._v(" "),i("FormItem",{attrs:{label:"价格小计"}},[i("Input",{attrs:{disabled:"true"},model:{value:e.total,callback:function(t){e.total=t},expression:"total"}})],1),e._v(" "),i("FormItem",[i("Button",{attrs:{type:"primary"},on:{click:e.postOrder}},[e._v("确认提交")]),e._v(" "),i("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning"}},[e._v("返回需求列表")])],1)],1),e._v(" "),i("Modal",{attrs:{title:"选择服务",width:80,styles:{top:"10px"},"mask-closable":!1},on:{"on-cancel":e.onCancelService,"on-ok":function(t){e.onSelectService()}},model:{value:e.modal.showSelectService.show,callback:function(t){e.$set(e.modal.showSelectService,"show",t)},expression:"modal.showSelectService.show"}},[i("Table",{attrs:{loading:e.modal.showSelectService.loading,columns:e.modal.showSelectService.serviceColumns,data:e.modal.showSelectService.serviceData}}),e._v(" "),i("div",{staticStyle:{"margin-top":"5px"}},[i("Page",{attrs:{size:"small",total:e.modal.showSelectService.total,current:e.modal.showSelectService.current},on:{"on-change":e.changeServicePage}})],1)],1),e._v(" "),i("Modal",{attrs:{width:80,"mask-closable":!1,title:"选择服务地址",styles:{top:"10px"}},on:{"on-ok":function(t){e.onSelectLocation(!1)}},model:{value:e.modal.showSelectLocation.show,callback:function(t){e.$set(e.modal.showSelectLocation,"show",t)},expression:"modal.showSelectLocation.show"}},[i("div",{staticClass:"amap-page-container"},[i("el-amap-search-box",{staticClass:"search-box",attrs:{"search-option":e.modal.showSelectLocation.searchOption,"on-search-result":e.onSearchResult}}),e._v(" "),i("el-amap",{ref:"map",staticClass:"amap-demo",attrs:{vid:"amapDemo","amap-manager":e.modal.showSelectLocation.amapManager,center:e.modal.showSelectLocation.center,zoom:e.modal.showSelectLocation.zoom,plugin:e.modal.showSelectLocation.plugin,events:e.modal.showSelectLocation.events}},[e._l(e.modal.showSelectLocation.markers,function(e,t){return i("el-amap-marker",{key:t,attrs:{position:e}})}),e._v(" "),i("el-amap-info-window",{attrs:{position:e.modal.showSelectLocation.currentWindow.position,content:e.modal.showSelectLocation.currentWindow.content,visible:e.modal.showSelectLocation.currentWindow.visible,events:e.modal.showSelectLocation.currentWindow.events}})],2)],1)]),e._v(" "),i("Modal",{attrs:{title:"选择服务周期"},model:{value:e.modal.showSelectTime.showOnce,callback:function(t){e.$set(e.modal.showSelectTime,"showOnce",t)},expression:"modal.showSelectTime.showOnce"}},[i("Form",{ref:"formInline"},[i("FormItem",{attrs:{label:"上门时间"}},[i("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"请选择上门时间","start-date":new Date},model:{value:e.modal.showSelectTime.onceData.time,callback:function(t){e.$set(e.modal.showSelectTime.onceData,"time",t)},expression:"modal.showSelectTime.onceData.time"}})],1),e._v(" "),e.modal.showSelectService.serviceData[0]&&e.modal.showSelectService.serviceData[0].service_value_unit_id?i("FormItem",{attrs:{label:"收费单位"}},[i("div",{staticClass:"selectUnit"},[i("div",{staticClass:"btn"},[i("div",{staticClass:"left",on:{click:function(t){e.setCycle(0)}}},[e._v("-")]),e._v(" "),i("div",{staticClass:"middle"},[e._v(e._s(e.modal.showSelectTime.onceData.length)),e.unitList.length>0?i("span",[e._v(e._s(e.getUnit(e.modal.showSelectService.serviceData[0].service_value_unit_id)))]):e._e()]),e._v(" "),i("div",{staticClass:"right",on:{click:function(t){e.setCycle(1)}}},[e._v("+")])])])]):e._e()],1)],1),e._v(" "),i("periodic-reservation",{on:{finish:e.selectWeek},model:{value:e.modal.showSelectTime.showWeek,callback:function(t){e.$set(e.modal.showSelectTime,"showWeek",t)},expression:"modal.showSelectTime.showWeek"}})],1)},staticRenderFns:[]};var y=i("VU/8")(S,w,!1,function(e){i("RpUH")},"data-v-6be76d38",null);t.default=y.exports},FGs9:function(e,t){},RpUH:function(e,t){},mvHQ:function(e,t,i){e.exports={default:i("qkKv"),__esModule:!0}},qkKv:function(e,t,i){var a=i("FeBl"),s=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}}});
//# sourceMappingURL=5.f59889316e67b05d57b6.js.map