webpackJsonp([2],{"1l78":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("fZjL"),i=a.n(o),n=a("GXH0"),s=a.n(n),c=(a("DmJO"),window.config.api_prefix||"http://jiajie-admin.7dugo.com"),r={name:"categoriesIndex",mounted:function(){this.getList()},components:{Treeselect:s.a},watch:{showModal:function(t){t?"==一级分类=="!==this.cateList[0].label&&this.cateList.unshift({label:"==一级分类==",id:0,parent_id:0}):this.cateList.shift()}},data:function(){return{api_key:c,modalTitle:"添加服务分类",showModal:!1,visible:!1,assetsPrefix:this.$config.baseURL,cateList:[],columns:[{label:"分类名称",prop:"label"},{label:"图标",prop:"cate_icon",width:60,headerAlign:"center",type:"template",template:"cateIcon"},{label:"分类编号",prop:"id",headerAlign:"center",width:100},{label:"是否显示",prop:"cate_is_show",headerAlign:"center",width:100,type:"template",template:"isShow"},{label:"操作",prop:"_action",headerAlign:"center",type:"template",template:"cateTools"}],cateForm:{parent_id:0,cat_name:"",pay_type:"",cate_icon:"",cate_is_show:"",cate_sort:"",cate_remark:""},props:{showRowHover:!0,isFold:!0,expandType:!1,selectionType:!1}}},methods:{getList:function(){var t=this;this.$http("category.list",{"data-set":"tree",field:"cat_name as label, cate_icon, cate_is_show"}).then(function(e){t.cateList=e.data})},onSwitchChange:function(t,e){var a=this;e-=1,this.cateList[e].loading=!0;var o=this.cateList[e].cate_is_show_bool;this.$http("category.change.show-"+t).then(function(){a.cateList[e].loading=!1}).catch(function(t){t.forEach(function(t){a.$Message.info(t)}),a.cateList[e].cate_is_show_bool=o})},handleUpdateCate:function(t){var e=this;this.$http("category.get-"+t).then(function(a){i()(e.cateForm).forEach(function(t){e.cateForm[t]=a.data[t]||""}),e.cateForm.id=t,e.showModal=!0,e.modalTitle="修改服务分类"})},handleMaxSize:function(t){this.$Notice.warning({title:"超过最大文件上传限制",desc:"文件  "+t.name+" 太大了, 最多允许上传大小 2M."})},handleFormatError:function(t){this.$Notice.warning({title:"文件格式不允许上传",desc:"文件 "+t.name+" 各位不允许上传"})},handleSuccess:function(t,e){0===t.error?this.cateForm.cate_icon=t.data.path:this.$Notice.warning({title:"文件上传失败",desc:"文件  "+e.name+" 文件上传失败."})},handlePost:function(){var t=this,e=void 0;e=this.cateForm.id?"category.update-"+this.cateForm.id:"category.add",this.$http(e,this.cateForm).then(function(){t.getList()})}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("Row",{staticStyle:{"margin-bottom":"10px"}},[a("Col",[a("Button",{attrs:{size:"small",type:"primary",icon:"md-add"},on:{click:function(e){t.showModal=!0}}},[t._v("新增服务分类")]),t._v(" "),a("Button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.props.isFold=!t.props.isFold}}},[t._v(t._s(t.props.isFold?"展开":"收起"))])],1)],1),t._v(" "),a("zk-table",{ref:"table",attrs:{"sum-text":"sum","index-text":"#",data:t.cateList,columns:t.columns,stripe:!0,border:!0,"tree-type":!0,"is-fold":t.props.isFold,"expand-type":!1,"selection-type":t.props.selectionType},scopedSlots:t._u([{key:"cateIcon",fn:function(e){return[a("img",{attrs:{src:t.api_key+"/"+e.row.cate_icon,width:"35",height:"35"}})]}},{key:"isShow",fn:function(e){return[a("i-switch",{attrs:{loading:e.row.loading},on:{"on-change":function(a){t.onSwitchChange(e.row.id,e.row._normalIndex)}},model:{value:e.row.cate_is_show_bool,callback:function(a){t.$set(e.row,"cate_is_show_bool",a)},expression:"scope.row.cate_is_show_bool"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("显")]),t._v(" "),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("隐")])])]}},{key:"cateTools",fn:function(e){return[a("Button",{attrs:{size:"small",type:"default",icon:"md-create"},on:{click:function(a){t.handleUpdateCate(e.row.id)}}},[t._v("修改")]),t._v(" "),a("Button",{attrs:{size:"small",type:"success",icon:"md-add"}},[t._v("添加下级")]),t._v(" "),a("Button",{attrs:{size:"small",type:"warning",icon:"md-trash"}},[t._v("删除")])]}}])}),t._v(" "),a("Modal",{attrs:{width:"200",title:"图标查看"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?a("img",{staticStyle:{width:"100%"},attrs:{src:t.cateIcon}}):t._e()]),t._v(" "),a("Modal",{attrs:{title:t.modalTitle},on:{"on-ok":t.handlePost},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("Form",{attrs:{"label-width":80},model:{value:t.cateForm,callback:function(e){t.cateForm=e},expression:"cateForm"}},[a("FormItem",{attrs:{prop:"cat_name",label:"上级分类"}},[a("treeselect",{ref:"roleSelect",staticStyle:{width:"300px"},attrs:{value:t.cateForm.parent_id||t.cateList[0].id,searchable:!1,multiple:!1,options:t.cateList,placeholder:"点击选择上级角色",noChildrenText:"该角色暂无下级"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"cat_name",label:"栏目名称"}},[a("Input",{model:{value:t.cateForm.cat_name,callback:function(e){t.$set(t.cateForm,"cat_name",e)},expression:"cateForm.cat_name"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"cate_sort",label:"栏目排序"}},[a("Input",{model:{value:t.cateForm.cate_sort,callback:function(e){t.$set(t.cateForm,"cate_sort",e)},expression:"cateForm.cate_sort"}})],1),t._v(" "),a("FormItem",{attrs:{prop:"cate_icon",label:"栏目图标"}},[a("div",[a("img",{attrs:{src:t.api_key+"/"+t.cateForm.cate_icon,width:"50",height:"50"}})]),t._v(" "),a("Upload",{attrs:{action:t.api_key+"/upload.image",name:"image",format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"show-upload-list":!1,"on-success":t.handleSuccess}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传文件")])],1)],1),t._v(" "),a("FormItem",{attrs:{prop:"cate_remark",label:"栏目简介"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.cateForm.cate_remark,callback:function(e){t.$set(t.cateForm,"cate_remark",e)},expression:"cateForm.cate_remark"}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(r,l,!1,function(t){a("q98L")},"data-v-2addc029",null);e.default=d.exports},q98L:function(t,e){}});
//# sourceMappingURL=2.f4de465f4f3146670cc0.js.map