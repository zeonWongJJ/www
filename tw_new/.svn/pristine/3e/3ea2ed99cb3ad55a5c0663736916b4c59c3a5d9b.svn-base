webpackJsonp([12],{DeqS:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("fZjL"),s=o.n(r),i=window.config.api_prefix||"http://jiajie-server.7dugo.com",a={name:"storeList",mounted:function(){var e=this;this.uploadList=this.$refs.upload.fileList,this.$http("store.list").then(function(t){e.data=t.data})},data:function(){var e=this;return{api_prefix:i,defaultFileList:[],uploadAction:i+"/upload.image",imgName:"",visible:!1,uploadList:[],itemForm:{store_name:"",store_director:"",store_phone:"",store_address:"",store_pic:[]},currentId:0,currentIndex:-1,form:{reason:"请输入拒绝的理由"},showItemModal:!1,showExampleModal:!1,columns:[{title:"店铺名称",key:"store_name"},{title:"负责人名字",key:"store_director"},{title:"负责人电话",key:"store_phone"},{title:"店铺等级",key:"store_level"},{title:"已售服务数量",key:"store_sold"},{title:"操作",width:320,key:"store_status",render:function(t,o){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.$router.push({name:"staffList",query:{storeId:o.row.id}})}}},"管理店员"),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.currentId=parseInt(o.row.id),e.$http("store.get-"+e.currentId).then(function(t){e.defaultFileList=e.uploadList=[],t.data.store_pic.forEach(function(o){e.defaultFileList.push({name:t.data.store_name,url:i+"/"+o})}),e.uploadList=e.defaultFileList,s()(e.itemForm).forEach(function(o){e.itemForm[o]=t.data[o]||""}),e.$nextTick(function(){e.showItemModal=!0})})}}},"查看详情"),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px",display:1==o.row.store_status||2==o.row.store_status?"inline-block":"none"},on:{click:function(){e.$router.push({path:"/services/comment",query:{store_id:o.row.id}})}}},"查看评论"),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px",display:0==o.row.store_status||-1==o.row.store_status?"inline-block":"none"},on:{click:function(){e.toExamineStore(o.row.id,o.index,1)}}},"通过审核"),t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px",display:0==o.row.store_status?"inline-block":"none"},on:{click:function(){e.currentId=o.row.id,e.currentIndex=o.index,e.showExampleModal=!0}}},"拒接审核"),t("Button",{props:{type:1==o.row.store_status?"error":"success",size:"small"},style:{display:1==o.row.store_status||2==o.row.store_status?"inline-block":"none"},on:{click:function(){e.updateStoreAuditing(o.row.id,o.index)}}},1==o.row.store_status?"停用店铺":"解除停用")])}}],data:[]}},methods:{handleView:function(e){this.imgName=e,this.visible=!0},handleRemove:function(e){var t=this,o=e.url.replace(i,"");this.$http("file.remove",{files:[o]}).then(function(o){if(0==o.error){var r=t.$refs.upload.fileList;t.uploadList.splice(r.indexOf(e),1)}})},handleSuccess:function(e){0==e.error&&this.uploadList.push({name:e.data.source_name,url:i+"/"+e.data.path,status:"finished"})},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},handleBeforeUpload:function(){var e=this.uploadList.length<5;return e||this.$Notice.warning({title:"Up to five pictures can be uploaded."}),e},toExamineStore:function(e,t,o){var r=this,s={pass:o,reason:this.form.reason};this.$http("store.shenhe-"+e,s).then(function(){r.data[t].store_status=o})},updateStoreAuditing:function(e,t){var o=this;this.$http("store.auditing-"+e).then(function(){var e=o.data[t].store_status;o.data[t].store_status=1==e?2:1})}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("Card",{attrs:{title:"店铺列表"}},[o("Table",{attrs:{columns:e.columns,data:e.data}}),e._v(" "),o("Modal",{attrs:{"mask-closable":!1,title:"输入审核不通过的理由"},on:{"on-ok":function(t){e.toExamineStore(e.currentId,e.currentIndex,-1)}},model:{value:e.showExampleModal,callback:function(t){e.showExampleModal=t},expression:"showExampleModal"}},[o("Form",{ref:"formInline",attrs:{model:e.form,"label-width":80}},[o("FormItem",{attrs:{prop:"reason",label:"拒绝理由"}},[o("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:e.form.reason},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1)],1)],1),e._v(" "),o("Modal",{attrs:{title:"查看店铺详情","mask-closable":!1,width:"80"},model:{value:e.showItemModal,callback:function(t){e.showItemModal=t},expression:"showItemModal"}},[o("Form",{attrs:{"label-width":90},model:{value:e.itemForm,callback:function(t){e.itemForm=t},expression:"itemForm"}},[o("FormItem",{attrs:{prop:"store_name",label:"店铺名称"}},[o("Input",{attrs:{placeholder:"输入店铺名称"},model:{value:e.itemForm.store_name,callback:function(t){e.$set(e.itemForm,"store_name",t)},expression:"itemForm.store_name"}})],1),e._v(" "),o("FormItem",{attrs:{prop:"store_name",label:"负责人姓名"}},[o("Input",{attrs:{placeholder:"服务人姓名"},model:{value:e.itemForm.store_director,callback:function(t){e.$set(e.itemForm,"store_director",t)},expression:"itemForm.store_director"}})],1),e._v(" "),o("FormItem",{attrs:{prop:"store_name",label:"负责人电话"}},[o("Input",{attrs:{placeholder:"负责人联系电话"},model:{value:e.itemForm.store_phone,callback:function(t){e.$set(e.itemForm,"store_phone",t)},expression:"itemForm.store_phone"}})],1),e._v(" "),o("FormItem",{attrs:{prop:"store_name",label:"店铺详细地址"}},[o("Input",{attrs:{placeholder:"店铺详细地址"},model:{value:e.itemForm.store_address,callback:function(t){e.$set(e.itemForm,"store_address",t)},expression:"itemForm.store_address"}})],1),e._v(" "),o("FormItem",{attrs:{prop:"store_name",label:"店铺图片"}},[e._l(e.uploadList,function(t){return o("div",{staticClass:"demo-upload-list"},["finished"==t.status?[o("img",{attrs:{src:t.url}}),e._v(" "),o("div",{staticClass:"demo-upload-list-cover"},[o("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(o){e.handleView(t.url)}}}),e._v(" "),o("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(o){e.handleRemove(t)}}})],1)]:[t.showProgress?o("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),e._v(" "),o("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"on-success":e.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"default-file-list":e.defaultFileList,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,multiple:"",name:"image",type:"drag",action:e.uploadAction}},[o("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[o("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)])],2)],1)],1),e._v(" "),o("Modal",{attrs:{title:"View Image"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?o("img",{staticStyle:{width:"100%"},attrs:{src:e.imgName}}):e._e()])],1)},staticRenderFns:[]};var l=o("VU/8")(a,n,!1,function(e){o("wlN8")},"data-v-5619972a",null);t.default=l.exports},wlN8:function(e,t){}});
//# sourceMappingURL=12.347cf3a3e9f00d831d7b.js.map